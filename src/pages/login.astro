---
import AuthLayout from "@/layouts/AuthLayout.astro";
import { LoginForm } from "@/components/auth/LoginForm";
import { getSafeNextPath } from "@/lib/http/redirect";

const rawNext = Astro.url.searchParams.get("next");
const next = getSafeNextPath(rawNext);

if (Astro.locals.auth?.isAuthenticated) {
  return Astro.redirect(next ?? "/dashboard");
}
---

<AuthLayout title="Logowanie â€” 10x Facts">
  <LoginForm client:load next={next} />
</AuthLayout>
